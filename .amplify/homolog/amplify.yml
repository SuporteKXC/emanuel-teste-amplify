version: 1
frontend:
  phases:
    preBuild:
      commands:
        - export NODE_OPTIONS=--max_old_space_size=4096
        - curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.3/install.sh | bash  # Instala o NVM
        - source $HOME/.nvm/nvm.sh  # Carrega o NVM explicitamente
        - nvm install 18         # Instala a versão 18 do Node.js
        - nvm use 18             # Usa a versão 18 do Node.js
        - node -v                # Exibe a versão do Node.js
        - yarn install           # Instala as dependências com yarn
    build:
      commands:
        - yarn build             # Executa o build com yarn
  artifacts:
    baseDirectory: build
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*      # Cache para otimizar builds futuros
